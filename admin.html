<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>ADMIN</title>
  <link rel='stylesheet' href='https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css'><link rel="stylesheet" href="./admin_style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>
<body>
<!-- partial:index.partial.html -->
<div class="wrapper">
    <div class="form-signin">       
      <h2 class="form-signin-heading">Please login</h2>
      <input type="password" id="firebase_key" class="form-control" name="username" placeholder="Enter Key" required="" autofocus="" />
      <input type="number" id="val" class="form-control" name="password" placeholder="Count" required=""/> 
      <label class="" id="request_status"></label>
      <button class="btn btn-lg btn-primary btn-block" id="send" onclick="send()">Update</button>   
    </div>
  </div>
<!-- partial -->
  <script type="text/javascript">
var ajaxResult = [];

function send(){
  var firebase_token = document.getElementById('firebase_key').value;
  var count = document.getElementById('val').value;
  console.log(firebase_token, count)
  
  if (firebase_token != atob('TmlsZUAyMDIx')) {
    document.getElementById('request_status').textContent = "error wrong key"
    document.getElementById('request_status').style.color = "red";
    document.getElementById('request_status').style.visibility = "visible";
    setTimeout(() => { document.getElementById('request_status').style.visibility = "hidden"; },5000 );
  }

  if (firebase_token == atob('TmlsZUAyMDIx')) {
        var settings = {
      "url": "https://" + atob('bmlsZS1jb3ZpZC1jYW1wLWRlZmF1bHQtcnRkYg==') + ".firebaseio.com/.json",
      "method": "PATCH",
      "timeout": 0,
      "headers": {
      "Content-Type": "text/plain"
        },
      "data": "{\"queue\":" + count + "}",
        };

      $.ajax(settings).done(function (response) {
        console.log(response);
        document.getElementById('request_status').textContent = "successfully updated"
        document.getElementById('request_status').style.color = "green";
        document.getElementById('request_status').style.visibility = "visible";
        setTimeout(() => { document.getElementById('request_status').style.visibility = "hidden"; },5000 );
      });             
                  
    }
  }
 


</script>
</body>
</html>
